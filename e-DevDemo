CREATE TABLE edevdemo.kullanici (
	kullanici_id serial primary key,
	kimlik_no bigint unique,  --bigint,numeric
	ad varchar,
	soy_ad varchar,
	cinsiyet bool,
	yas int,
	telefon varchar(14) unique,
	mail varchar(20) unique,
	kullanici_olusma_tarihi timestamp

);

CREATE TABLE edevdemo.kurum(
	kurum_id serial,
	kurum_kodu int unique,
	kurum_adi varchar(50),
	kurum_tipi int,
	primary key(kurum_id)
	
);

CREATE TABLE edevdemo.ozel (
	ozel_kurum_id serial,
	kurum_id int ,
	CONSTRAINT fk_kurum FOREIGN KEY(kurum_id) REFERENCES edevdemo.kurum(kurum_id)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);

CREATE TABLE edevdemo.kamu (
	kamu_id serial,
	kurum_id int,
	ust_kurum_kodu int,
	CONSTRAINT fk_kurum FOREIGN KEY(kurum_id) REFERENCES edevdemo.kurum(kurum_id)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);

CREATE TABLE edevdemo.banka (
	banka_id serial,
	banka_kodu int primary key,
	kurum_id int,
	CONSTRAINT fk_kurum FOREIGN KEY(kurum_id) REFERENCES edevdemo.kurum(kurum_id)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);

create table edevdemo.hizmet (
	hizmet_id INT GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
	hizmet_kodu int unique,
	hizmet_adi varchar(50),
	hizmet_tipi int,
	hizmet_acilis_tarihi timestamp,
	kurum_id int,
	etkin boolean,
	hizmet_linki varchar,
	primary key(hizmet_id),
	constraint fk_kurum foreign key(kurum_id) references edevdemo.kurum(kurum_id)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);

create table edevdemo.mobil_hizmet(
	mobil_hizmet_id int,
	isletim_sistemi varchar,
	os_version varchar,
	constraint fk_hizmet foreign key(mobil_hizmet_id) references edevdemo.hizmet(hizmet_id)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);

create table edevdemo.web_hizmet(
	web_hizmet_id int,
	constraint fk_hizmet foreign key(web_hizmet_id) references edevdemo.hizmet(hizmet_id)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);

create table edevdemo.ref_banka(
	banka_kodu int,
	banka_adi varchar(50),
	constraint fk_banka foreign key(banka_kodu) references edevdemo.banka(banka_kodu)
	ON DELETE CASCADE
	ON UPDATE CASCADE
);
 
CREATE TABLE edevdemo.iller(
il_kodu int unique primary key,
isim VARCHAR(50)
--constraint fk_il_kodu foreign key(il_kodu) references belediye(il_kodu)
);
 
CREATE TABLE edevdemo.ilceler(
ilce_kodu int unique primary key,
isim VARCHAR(50),
il_kodu int NOT NULL,
CONSTRAINT fk_il_kodu FOREIGN KEY (il_kodu)
REFERENCES edevdemo.iller(il_kodu)
ON DELETE CASCADE
ON UPDATE cascade
);

-- foreign key silince diÄŸeri de
CREATE TABLE edevdemo.belediye (
	belediye_id serial,
	kurum_id int,
	il_kodu int unique, --il kodu
	ilce_kodu int unique, --ilce kodu
    CONSTRAINT fk_kurum FOREIGN KEY(kurum_id) REFERENCES edevdemo.kurum(kurum_id)
    ON DELETE CASCADE
	ON UPDATE CASCADE
);

ALTER TABLE edevdemo.belediye
    ADD FOREIGN KEY (il_kodu)
    REFERENCES edevdemo.iller(il_kodu)
    NOT VALID;


ALTER TABLE edevdemo.belediye
    ADD FOREIGN KEY (ilce_kodu)
    REFERENCES edevdemo.ilceler(ilce_kodu)
    NOT VALID;
   

